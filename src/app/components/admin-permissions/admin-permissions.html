<div class="admin-container">
  <div class="page-header">
    <h1>Matriz de Permisos</h1>
    <p class="text-muted">Define qu√© puede hacer cada rol en el sistema.</p>
  </div>

  @if (isLoading()) {
    <div class="text-center p-5">Cargando matriz...</div>
  } @else {
    <div class="table-responsive">
      <table class="matrix-table">
        <thead>
          <tr>
            <th class="permiso-col">Permiso / Roles</th>
            @for (rol of roles(); track rol.id) {
              <th class="role-header">
                {{ rol.nombre }}
              </th>
            }
          </tr>
        </thead>
        <tbody>
          @for (permiso of permisos(); track permiso.id) {
            <tr>
              <td class="permiso-cell">
                <strong>{{ permiso.nombre }}</strong><br>
                <small class="code-text">{{ permiso.codigoInterno }}</small>
              </td>

              @for (rol of roles(); track rol.id) {
                <td class="check-cell text-center">
                  <div class="custom-checkbox">
                    <input type="checkbox" 
                           [id]="'p_' + rol.id + '_' + permiso.id"
                           [checked]="hasPermission(rol, permiso.id)"
                           (change)="togglePermission(rol, permiso.id, $event)">
                    <label [for]="'p_' + rol.id + '_' + permiso.id" class="checkmark"></label>
                  </div>
                </td>
              }
            </tr>
          }
        </tbody>
      </table>
    </div>
  }
</div>